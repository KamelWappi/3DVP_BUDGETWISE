{% extends "base.html" %}

{% block title %}Dashboard - Mon Budget{% endblock %}

{% block content %}
<div class="container my-4">

    <h1 class="mb-4"><i class="bi bi-speedometer2"></i> Mon Budget</h1>

    <!-- Résumé -->
    <div class="row mb-4">
        <div class="col-md-4">
            <div class="card text-success text-center">
                <div class="card-body">
                    <h5>Total Revenus</h5>
                    <p class="fs-3">{{ "%.2f"|format(total_revenus) }} €</p>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card text-danger text-center">
                <div class="card-body">
                    <h5>Total Dépenses</h5>
                    <p class="fs-3">{{ "%.2f"|format(total_depenses) }} €</p>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card text-center">
                <div class="card-body">
                    <h5>Solde</h5>
                    <p class="fs-3 {{ 'text-success' if solde >= 0 else 'text-danger' }}">
                        {{ "%.2f"|format(solde) }} €
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Dernières transactions -->
    <div class="card mb-4">
        <div class="card-header">
            <i class="bi bi-clock-history"></i> Dernières Transactions
        </div>
        <div class="card-body">
            {% if dernieres_transactions %}
                <ul class="list-group">
                    {% for t in dernieres_transactions %}
                    <li class="list-group-item d-flex justify-content-between">
                        <div>
                            <strong>{{ t.description }}</strong><br>
                            <small>{{ t.date.strftime('%d/%m/%Y') }}</small>
                        </div>
                        <span class="badge {{ 'bg-success' if t.type == 'revenu' else 'bg-danger' }}">
                            {{ '+' if t.type == 'revenu' else '-' }}{{ "%.2f"|format(t.montant) }} €
                        </span>
                    </li>
                    {% endfor %}
                </ul>
            {% else %}
                <p class="text-muted text-center">Aucune transaction enregistrée.</p>
            {% endif %}
        </div>
    </div>

    <!-- Dépenses par catégorie -->
    <div class="card mb-4">
        <div class="card-header">
            <i class="bi bi-pie-chart"></i> Dépenses par Catégorie
        </div>
        <div class="card-body">
            {% if stats_categories %}
                <ul class="list-group">
                    {% for c in stats_categories %}
                    <li class="list-group-item d-flex justify-content-between">
                        <span>{{ c.categorie }}</span>
                        <span>{{ "%.2f"|format(c.total) }} €</span>
                    </li>
                    {% endfor %}
                </ul>
            {% else %}
                <p class="text-muted text-center">Aucune dépense enregistrée.</p>
            {% endif %}
        </div>
    </div>

    <!-- Actions rapides -->
    <div class="text-center">
        <a href="{{ url_for('ajouter_revenu') }}" class="btn btn-success me-2">
            <i class="bi bi-plus-circle"></i> Ajouter un Revenu
        </a>
        <a href="{{ url_for('ajouter_depense') }}" class="btn btn-danger me-2">
            <i class="bi bi-dash-circle"></i> Ajouter une Dépense
        </a>
        <a href="{{ url_for('statistiques') }}" class="btn btn-primary">
            <i class="bi bi-bar-chart"></i> Voir les Statistiques
        </a>
    </div>

</div>
{% endblock %}
